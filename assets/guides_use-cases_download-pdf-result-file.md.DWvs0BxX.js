import{_ as n,D as t,c as l,b as r,w as e,a4 as p,a3 as o,o as s,I as i,a as c}from"./chunks/framework.BG__5Sii.js";const g=JSON.parse('{"title":"Download PDF Result File","description":"Learn how to automatically download the PDF result file once a record has been completed by the user with a result available, using the `record.finished` webhook and the Records download endpoint.","frontmatter":{"title":"Download PDF Result File","description":"Learn how to automatically download the PDF result file once a record has been completed by the user with a result available, using the `record.finished` webhook and the Records download endpoint."},"headers":[],"relativePath":"guides/use-cases/download-pdf-result-file.md","filePath":"guides/use-cases/download-pdf-result-file.md","lastUpdated":1750694364000}'),d={name:"guides/use-cases/download-pdf-result-file.md"},h=o('<h1 id="download-pdf-result-file" tabindex="-1">Download PDF result file <a class="header-anchor" href="#download-pdf-result-file" aria-label="Permalink to &quot;Download PDF result file&quot;">​</a></h1><p>This guide demonstrates how to use the <code>record.finished</code> webhook to know when a record has been completed by the user with a result available, and then download the resulting PDF file via our API. The PDF returned by the download endpoint is the same file shown in the back-office.</p><h2 id="prerequisites" tabindex="-1">Prerequisites <a class="header-anchor" href="#prerequisites" aria-label="Permalink to &quot;Prerequisites&quot;">​</a></h2><ul><li><strong>Amiqus API credentials:</strong> Ensure you have valid credentials to authenticate your requests.</li><li><strong>Webhook subscription:</strong> You must be subscribed to the <a href="https://developers.amiqus.co/guides/webhooks.html#available-webhooks" target="_blank" rel="noreferrer"><code>record.finished</code></a> event in your <a href="https://id.amiqus.co/team/workflow/webhooks" target="_blank" rel="noreferrer">webhook settings</a>.</li><li><strong>Stored record ID:</strong> When you created the record (via the <a href="https://developers.amiqus.co/aqid/api-reference.html#tag/Records/operation/post-records" target="_blank" rel="noreferrer">Create a Record</a> endpoint), you should have stored the returned <code>record_id</code>. <ul><li>If you have not created a Client and Record yet, you can follow this <a href="/guides/use-cases/registration-flow.html" target="_blank">Registration Flow</a> guide to create a client and record.</li></ul></li></ul><h2 id="overview-of-the-flow" tabindex="-1">Overview of the flow <a class="header-anchor" href="#overview-of-the-flow" aria-label="Permalink to &quot;Overview of the flow&quot;">​</a></h2>',5),u=o(`<h2 id="step-by-step-guide" tabindex="-1">Step-by-step guide <a class="header-anchor" href="#step-by-step-guide" aria-label="Permalink to &quot;Step-by-step guide&quot;">​</a></h2><h3 id="_1-subscribe-to-the-record-finished-webhook" tabindex="-1">1. Subscribe to the <code>record.finished</code> webhook <a class="header-anchor" href="#_1-subscribe-to-the-record-finished-webhook" aria-label="Permalink to &quot;1. Subscribe to the \`record.finished\` webhook&quot;">​</a></h3><p>In your Amiqus dashboard, add your endpoint URL under <strong>Webhooks</strong> and select the <a href="https://developers.amiqus.co/guides/webhooks.html#available-webhooks" target="_blank" rel="noreferrer"><code>record.finished</code></a> event.</p><p>A sample webhook payload will look like:</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  &quot;</span><span style="color:#C792EA;">webhook</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#FFCB6B;">uuid</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">db6a2d91-b67e-4f88-b71a-b73da98c5168</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#FFCB6B;">created_at</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">2023-02-11T13:01:34Z</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#FFCB6B;">events</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> [</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">*</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#89DDFF;">  },</span></span>
<span class="line"><span style="color:#89DDFF;">  &quot;</span><span style="color:#C792EA;">trigger</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#FFCB6B;">triggered_at</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">2023-06-28T16:15:27Z</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#FFCB6B;">alias</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">record.finished</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">  },</span></span>
<span class="line"><span style="color:#89DDFF;">  &quot;</span><span style="color:#C792EA;">data</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;">    &quot;</span><span style="color:#FFCB6B;">record</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#F78C6C;">id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;"> 1</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#F78C6C;">show</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">https://id.amiqus.co/api/v2/records/1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      &quot;</span><span style="color:#F78C6C;">download</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">https://id.amiqus.co/api/v2/records/1/download</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">    }</span></span>
<span class="line"><span style="color:#89DDFF;">  }</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><h3 id="_2-receive-the-webhook" tabindex="-1">2. Receive the webhook <a class="header-anchor" href="#_2-receive-the-webhook" aria-label="Permalink to &quot;2. Receive the webhook&quot;">​</a></h3><p>When a user completes all checks, Amiqus will send a <code>POST</code> request to your endpoint. The webhook will contain a payload with the record ID and a download URL as shown above.</p><h3 id="_3-download-the-pdf-result-file" tabindex="-1">3. Download the PDF result file <a class="header-anchor" href="#_3-download-the-pdf-result-file" aria-label="Permalink to &quot;3. Download the PDF result file&quot;">​</a></h3><p>Use the <code>download</code> URL from the webhook to call the <a href="/aqid/api-reference.html#tag/Records/operation/get-records-id-download" target="_blank">Download a Record</a> endpoint. This returns the PDF binary, which you can save.</p><h2 id="what-happens-next" tabindex="-1">What happens next? <a class="header-anchor" href="#what-happens-next" aria-label="Permalink to &quot;What happens next?&quot;">​</a></h2><ul><li><strong>Store the PDF:</strong> Save it to your storage.</li><li><strong>Log the download:</strong> Record audit details (timestamp, <code>recordId</code>, user) for compliance.</li><li><strong>Notify stakeholders:</strong> Optionally send an email or internal notification confirming the result is available.</li><li><strong>Error handling:</strong> If the endpoint returns a non-200 response, log the error and retry or alert your team.</li></ul>`,11);function F(D,y,b,f,w,q){const a=t("Mermaid");return s(),l("div",null,[h,(s(),r(p,null,{default:e(()=>[i(a,{id:"mermaid-36",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20Amiqus%20as%20Amiqus%20Webhook%0A%20%20%20%20participant%20YourSystem%20as%20Your%20System%0A%20%20%20%20participant%20AmiqusAPI%20as%20Amiqus%20API%0A%0A%20%20%20%20Amiqus-%3E%3EYourSystem%3A%20POST%20%2Fwebhooks%20(record.finished)%0A%20%20%20%20YourSystem-%3E%3EAmiqusAPI%3A%20GET%20%2Frecords%2F%7BrecordId%7D%2Fdownload%0A%20%20%20%20AmiqusAPI--%3E%3EYourSystem%3A%20PDF%20binary%20response%0A"})]),fallback:e(()=>[c(" Loading... ")]),_:1})),u])}const _=n(d,[["render",F]]);export{g as __pageData,_ as default};
